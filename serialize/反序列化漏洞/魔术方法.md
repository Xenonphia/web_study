---
tags:
  - serialize
  - PHP
Date: 2026-01-11
---
# 魔术方法
一个预定义好的，在特定情况下自动触发的行为方法

## 作用
由于反序列化unserialize()接收的值可控，因此通过调用方法触发代码执行

## 相关机制
<mark style="background: #FFB8EBA6;">触发时机</mark>
功能
<mark style="background: #FFB8EBA6;">参数</mark>
返回值

# \_\_construct()
构造函数
在实例化对象的时候就会触发

![](assets/魔术方法/file-20260111150852163.png)

![](assets/魔术方法/file-20260111151147277.png)

\$this也代表当前对象
由此可见__construct函数在实例化对象的时候会自动触发执行

<mark style="background: #FFB8EBA6;">参数部分</mark>
是非必要传入的，具体看方法内部
### 对比序列化和反序列化的过程
只有魔术方法在此条件下触发

# \_\_destruct
与construct函数对称的
<mark style="background: #FFB8EBA6;">析构函数</mark>
在对象的所有引用被删除或者当对象被显式销毁时执行的魔术方法
```php
<?php

//highlight_file(__FILE__);

class User {

    public function __destruct()

    {

        echo "触发了析构函数1次"."<br />" ;

    }

}

$test = new User("benben");

$ser = serialize($test);

unserialize($ser);

  

?>
```

![](assets/魔术方法/file-20260111152010829.png)

在new实例化对象完成后触发一次
在序列化的时候不受影响
反序列化之后重新由字符串转为对象再次触发一次