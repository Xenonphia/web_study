---
tags:
  - PHP
  - serialize
Date: 2026-01-30
---
例题代码
```php
<?php  
highlight_file(__FILE__);  
error_reporting(0);  
function filter($name){    $safe=array("flag","php");    $name=str_replace($safe,"hack",$name);  
    return $name;  
}  
class test{  
    var $user;  
    var $pass='daydream';  
    function __construct($user){        $this->user=$user;  
    }  
}  
$param=$_GET['param'];  
$param=serialize(new test($param));  
$profile=unserialize(filter($param));  
  
if ($profile->pass=='escaping'){  
    echo file_get_contents("flag.php");  
}  
?>
```
### 分析
1.读取flag内容的条件是变量`pass==escaping`
2.param用以接收get提交的参数，并且赋值给param变量，随后将传入的值在test类实例化对象
3.给变量profile赋值过滤后的param

### 问题
1.没有直接给pass属性赋值
2.过滤函数将php->hack过程种字符变多

### 考虑到是增多的字符串逃逸
将pass属性吐出