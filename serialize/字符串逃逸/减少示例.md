---
tags:
  - PHP
  - serialize
Date: 2026-01-30
---
例题代码
```php
<?php  
highlight_file(__FILE__);  
error_reporting(0);  
function filter($name){    $safe=array("flag","php");    $name=str_replace($safe,"hk",$name);  
    return $name;  
}  
class test{  
    var $user;  
    var $pass;  
    var $vip = false ;  
    function __construct($user,$pass){        $this->user=$user;    $this->pass=$pass;  
    }  
}  
$param=$_GET['user'];  
$pass=$_GET['pass'];  
$param=serialize(new test($param,$pass));  
$profile=unserialize(filter($param));  
  
if ($profile->vip){  
    echo file_get_contents("flag.php");  
}  
?>
```
### 分析
1.通过user和pass的get传递给变量赋值
2.给param赋值序列化后的实例对象
3.过滤实例对象，最后判断属性vip是否为真，原始为false

### 问题
1.php和flag被过滤，字符替换为更短的hk

### 考虑减少的字符串逃逸
先构造出关键属性vip
```php

```