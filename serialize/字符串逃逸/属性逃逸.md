---
tags:
  - PHP
  - serialize
Date: 2026-01-29
---
一般在数据先经过依次序列化后再反序列化，在中间反序列化的字符串变多或者变少的时候才可能存在属性逃逸

# 减少逃逸

例如：
```php
<?php
//highlight_file(__FILE__);
error_reporting(0);
class A{
    public $v1 = "abcsystem()system()system()";
    public $v2 = '123';
}

$data = serialize(new A());
echo $data."\n";

$data = str_replace("system()","",$data);
echo $data."\n";

var_dump(unserialize($data));
?>
```
利用replace函数可以过滤序列化字符串的数据

![](assets/属性逃逸/file-20260129180515988.png)

此时vardump也会因为数据不对报错

p1.
利用2个system()刚好能够利用29\;末尾的引号闭合
（刚好是v2字符串开始的标识）
```php
<?php
//highlight_file(__FILE__);
error_reporting(0);
class A{
    public $v1 = "abcsystem()system()";
    public $v2 = ';s:2:"v3";s:10:"passthru()";}';
}

  

$data = serialize(new A());
echo $data."\n";

$data = str_replace("system()","",$data);
echo $data."\n";
var_dump(unserialize($data));
?>
```

![](assets/属性逃逸/file-20260129183124258.png)

p2.
利用更多的system()---3个，因此需要在v2部分添加内容，并且最后一位添加双引号用来闭合v1
对应1234567的七位加上一位"，对比上述多了一个八位的system()
```php
<?php
//highlight_file(__FILE__);
error_reporting(0);
class A{
    public $v1 = "abcsystem()system()system()";
    public $v2 = '1234567";s:2:"v3";s:10:"passthru()";}';
}

  

$data = serialize(new A());
echo $data."\n";

$data = str_replace("system()","",$data);
echo $data."\n";
var_dump(unserialize($data));
?>
```

![](assets/属性逃逸/file-20260129183551763.png)

# 增多逃逸

